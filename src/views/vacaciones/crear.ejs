<div class="d-flex justify-content-between align-items-center mb-4">
  <div>
    <h2 class="mb-1"><i class="bi bi-calendar-plus me-2"></i>Registrar Vacaciones</h2>
    <p class="text-muted mb-0">Solicitar vacaciones para un empleado</p>
  </div>
  <a href="/vacaciones" class="btn btn-outline-secondary">
    <i class="bi bi-arrow-left me-1"></i> Volver
  </a>
</div>

<% if (typeof messages !== 'undefined' && messages.error) { %>
  <div class="alert alert-danger alert-dismissible fade show">
    <i class="bi bi-exclamation-circle me-2"></i><%= messages.error %>
    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
  </div>
<% } %>

<div class="card">
  <div class="card-body">
    <form action="/vacaciones" method="POST">
      <div class="row g-3">
        <div class="col-md-12">
          <label for="ID_Empleado" class="form-label">Empleado *</label>
          <select class="form-select" id="ID_Empleado" name="ID_Empleado" required>
            <option value="">Seleccionar empleado...</option>
            <% empleados.forEach(emp => { %>
              <option value="<%= emp.ID_Empleado %>">
                <%= emp.Nombre %> <%= emp.Apellido_Paterno %> <%= emp.Apellido_Materno || '' %>
              </option>
            <% }) %>
          </select>
          <div class="form-text">Solo empleados con al menos 1 año de antigüedad pueden solicitar vacaciones</div>
        </div>
        
        <div class="col-md-6">
          <label for="Fecha_Inicio" class="form-label">Fecha de Inicio *</label>
          <input type="date" class="form-control" id="Fecha_Inicio" name="Fecha_Inicio" required>
        </div>
        
        <div class="col-md-6">
          <label for="Fecha_Fin" class="form-label">Fecha de Fin *</label>
          <input type="date" class="form-control" id="Fecha_Fin" name="Fecha_Fin" required>
        </div>
        
        <div class="col-md-12">
          <div class="alert alert-info" id="diasInfo" style="display: none;">
            <i class="bi bi-info-circle me-1"></i>
            <span id="diasTexto"></span>
          </div>
        </div>
        
        <div class="col-md-12">
          <label for="Observaciones" class="form-label">Observaciones</label>
          <textarea class="form-control" id="Observaciones" name="Observaciones" rows="2"
                    placeholder="Notas adicionales..."></textarea>
        </div>
      </div>
      
      <hr class="my-4">
      
      <div class="d-flex gap-2">
        <button type="submit" class="btn btn-primary">
          <i class="bi bi-check-lg me-1"></i> Registrar Vacaciones
        </button>
        <a href="/vacaciones" class="btn btn-outline-secondary">Cancelar</a>
      </div>
    </form>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const fechaInicio = document.getElementById('Fecha_Inicio');
  const fechaFin = document.getElementById('Fecha_Fin');
  const diasInfo = document.getElementById('diasInfo');
  const diasTexto = document.getElementById('diasTexto');
  
  function calcularDias() {
    if (fechaInicio.value && fechaFin.value) {
      const inicio = new Date(fechaInicio.value);
      const fin = new Date(fechaFin.value);
      const dias = Math.ceil((fin - inicio) / (1000 * 60 * 60 * 24)) + 1;
      
      if (dias > 0) {
        diasTexto.textContent = `Se solicitarán ${dias} día(s) de vacaciones`;
        diasInfo.style.display = 'block';
      } else {
        diasInfo.style.display = 'none';
      }
    }
  }
  
  fechaInicio.addEventListener('change', calcularDias);
  fechaFin.addEventListener('change', calcularDias);
});
</script>
